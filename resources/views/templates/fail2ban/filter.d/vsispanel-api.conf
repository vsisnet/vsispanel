# Fail2Ban filter for VSISPanel API rate limiting and brute force
# Author: VSISPanel

[Definition]

# Option:  failregex
# Notes.:  Matches API failures and rate limit exceeded from VSISPanel
# Values:  TEXT

failregex = ^.*API rate limit exceeded.*client:\s*<HOST>.*$
            ^.*Too many requests.*IP:\s*<HOST>.*$
            ^.*API authentication failed.*<HOST>.*$
            ^.*Unauthorized API access.*from\s*<HOST>.*$

# Option:  ignoreregex
# Notes.:  regex to ignore
# Values:  TEXT

ignoreregex =

# Option:  datepattern
# Notes.:  regex to match date pattern in log
# Values:  TEXT

datepattern = %%Y-%%m-%%d %%H:%%M:%%S
              %%Y/%%m/%%d %%H:%%M:%%S
              %%b %%d %%H:%%M:%%S
